"use strict";let direction="ltr";isRtl&&(direction="rtl"),document.addEventListener("DOMContentLoaded",(function(){!function(){const e=document.getElementById("calendar"),t=document.querySelector(".app-calendar-sidebar"),n=document.getElementById("addEventSidebar"),a=document.querySelector(".app-overlay"),l={Business:"primary",Holiday:"success",Personal:"danger",Family:"warning",ETC:"info"},r=document.querySelector(".offcanvas-title"),i=document.querySelector(".btn-toggle-sidebar"),d=document.querySelector(".btn-add-event"),o=document.querySelector(".btn-update-event"),s=document.querySelector(".btn-delete-event"),c=document.querySelector(".btn-cancel"),u=document.querySelector("#eventTitle"),v=document.querySelector("#eventStartDate"),m=document.querySelector("#eventEndDate"),p=document.querySelector("#eventURL"),f=$("#eventLabel"),g=$("#eventGuests"),h=document.querySelector("#eventLocation"),b=document.querySelector("#eventDescription"),y=document.querySelector(".allDay-switch"),S=document.querySelector(".select-all"),L=[].slice.call(document.querySelectorAll(".input-filter")),E=document.querySelector(".inline-calendar");let k,w,x=events,q=!1;const D=new bootstrap.Offcanvas(n);if(f.length){function R(e){return e.id?"<span class='badge badge-dot bg-"+$(e.element).data("label")+" me-2'> </span>"+e.text:e.text}f.wrap('<div class="position-relative"></div>').select2({placeholder:"Select value",dropdownParent:f.parent(),templateResult:R,templateSelection:R,minimumResultsForSearch:-1,escapeMarkup:function(e){return e}})}if(g.length){function G(e){return e.id?"<div class='d-flex flex-wrap align-items-center'><div class='avatar avatar-xs me-2'><img src='"+assetsPath+"img/avatars/"+$(e.element).data("avatar")+"' alt='avatar' class='rounded-circle' /></div>"+e.text+"</div>":e.text}g.wrap('<div class="position-relative"></div>').select2({placeholder:"Select value",dropdownParent:g.parent(),closeOnSelect:!1,templateResult:G,templateSelection:G,escapeMarkup:function(e){return e}})}if(v)var P=v.flatpickr({enableTime:!0,altFormat:"Y-m-dTH:i:S",onReady:function(e,t,n){n.isMobile&&n.mobileInput.setAttribute("step",null)}});if(m)var M=m.flatpickr({enableTime:!0,altFormat:"Y-m-dTH:i:S",onReady:function(e,t,n){n.isMobile&&n.mobileInput.setAttribute("step",null)}});function T(){const e=document.querySelector(".fc-sidebarToggle-button");for(e.classList.remove("fc-button-primary"),e.classList.add("d-lg-none","d-inline-block","ps-0");e.firstChild;)e.firstChild.remove();e.setAttribute("data-bs-toggle","sidebar"),e.setAttribute("data-overlay",""),e.setAttribute("data-target","#app-calendar-sidebar"),e.insertAdjacentHTML("beforeend",'<i class="bx bx-menu bx-sm text-body"></i>')}E&&(w=E.flatpickr({monthSelectorType:"static",inline:!0}));let{dayGrid:A,interaction:F,timeGrid:Y,list:C}=calendarPlugins,V=new Calendar(e,{initialView:"dayGridMonth",events:function(e,t){let n=function(){let e=[];return[].slice.call(document.querySelectorAll(".input-filter:checked")).forEach((t=>{e.push(t.getAttribute("data-value"))})),e}();t(x.filter((function(e){return n.includes(e.extendedProps.calendar.toLowerCase())})))},plugins:[F,A,Y,C],editable:!0,dragScroll:!0,dayMaxEvents:2,eventResizableFromStart:!0,customButtons:{sidebarToggle:{text:"Sidebar"}},headerToolbar:{start:"sidebarToggle, prev,next, title",end:"dayGridMonth,timeGridWeek,timeGridDay,listMonth"},direction:direction,initialDate:new Date,navLinks:!0,eventClassNames:function({event:e}){return["fc-event-"+l[e._def.extendedProps.calendar]]},dateClick:function(e){let t=moment(e.date).format("YYYY-MM-DD");I(),D.show(),r&&(r.innerHTML="Add Event"),d.classList.remove("d-none"),o.classList.add("d-none"),s.classList.add("d-none"),v.value=t,m.value=t},eventClick:function(e){!function(e){k=e.event,k.url&&(e.jsEvent.preventDefault(),window.open(k.url,"_blank")),D.show(),d.classList.add("d-none"),o.classList.remove("d-none"),r&&(r.innerHTML="Update Event"),s.classList.remove("d-none"),u.value=k.title,P.setDate(k.start,!0,"Y-m-d"),!0===k.allDay?y.checked=!0:y.checked=!1,null!==k.end?M.setDate(k.end,!0,"Y-m-d"):M.setDate(k.start,!0,"Y-m-d"),f.val(k.extendedProps.calendar).trigger("change"),void 0!==k.extendedProps.location&&(h.value=k.extendedProps.location),void 0!==k.extendedProps.guests&&g.val(k.extendedProps.guests).trigger("change"),void 0!==k.extendedProps.description&&(b.value=k.extendedProps.description)}(e)},datesSet:function(){T()},viewDidMount:function(){T()}});V.render(),T();const B=document.getElementById("eventForm");FormValidation.formValidation(B,{fields:{eventTitle:{validators:{notEmpty:{message:"Please enter event title "}}},eventStartDate:{validators:{notEmpty:{message:"Please enter start date "}}},eventEndDate:{validators:{notEmpty:{message:"Please enter end date "}}}},plugins:{trigger:new FormValidation.plugins.Trigger,bootstrap5:new FormValidation.plugins.Bootstrap5({eleValidClass:"",rowSelector:function(e,t){return".mb-3"}}),submitButton:new FormValidation.plugins.SubmitButton,autoFocus:new FormValidation.plugins.AutoFocus}}).on("core.form.valid",(function(){q=!0}));i&&i.addEventListener("click",(e=>{c.classList.remove("d-none")}));function I(){m.value="",p.value="",v.value="",u.value="",h.value="",y.checked=!1,g.val("").trigger("change"),b.value=""}d.addEventListener("click",(e=>{if(q){let e={id:V.getEvents().length+1,title:u.value,start:v.value,end:m.value,startStr:v.value,endStr:m.value,display:"block",extendedProps:{location:h.value,guests:g.val(),calendar:f.val(),description:b.value}};p.value&&(e.url=p.value),y.checked&&(e.allDay=!0),t=e,x.push(t),V.refetchEvents(),D.hide()}var t})),o.addEventListener("click",(e=>{if(q){!function(e){e.id=parseInt(e.id),x[x.findIndex((t=>t.id===e.id))]=e,V.refetchEvents()}({id:k.id,title:u.value,start:v.value,end:m.value,url:p.value,extendedProps:{location:h.value,guests:g.val(),calendar:f.val(),description:b.value},display:"block",allDay:!!y.checked}),D.hide()}})),s.addEventListener("click",(e=>{var t;t=parseInt(k.id),x=x.filter((function(e){return e.id!=t})),V.refetchEvents(),D.hide()})),n.addEventListener("hidden.bs.offcanvas",(function(){I()})),i.addEventListener("click",(e=>{s.classList.add("d-none"),o.classList.add("d-none"),d.classList.remove("d-none"),t.classList.remove("show"),a.classList.remove("show")})),S&&S.addEventListener("click",(e=>{e.currentTarget.checked?document.querySelectorAll(".input-filter").forEach((e=>e.checked=1)):document.querySelectorAll(".input-filter").forEach((e=>e.checked=0)),V.refetchEvents()})),L&&L.forEach((e=>{e.addEventListener("click",(()=>{document.querySelectorAll(".input-filter:checked").length<document.querySelectorAll(".input-filter").length?S.checked=!1:S.checked=!0,V.refetchEvents()}))})),w.config.onChange.push((function(e){V.changeView(V.view.type,moment(e[0]).format("YYYY-MM-DD")),T(),t.classList.remove("show"),a.classList.remove("show")}))}()}));
